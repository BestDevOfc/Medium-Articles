<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How students are compromising their school’s internal networks. Part 2</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How students are compromising their school’s internal networks. Part 2</h1>
</header>
<section data-field="subtitle" class="p-summary">
This article explores the vulnerabilities in school networks, focusing on how students compromise them. We discuss Active Directory…
</section>
<section data-field="body" class="e-content">
<section name="f7b5" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8fd2" id="8fd2" class="graf graf--h3 graf--leading graf--title">How students are compromising their school’s internal networks. Part 2</h3><p name="4744" id="4744" class="graf graf--p graf-after--h3">This article explores the vulnerabilities in school networks, focusing on how students compromise them. We discuss Active Directory, bypassing content filters, and Chromebooks. We explain how students escalate their privileges allowing them to access restricted resources, and even leak school data using dual-booting. Moreover, security flaws such as default credentials that lead to data breaches are explained. This article is meant to raise awareness and help better protect our education’s critical infrastructure. Read Part 1 here: <a href="https://medium.com/thedeephub/how-students-are-compromising-their-schools-internal-networks-5e8603bf1ae1" data-href="https://medium.com/thedeephub/how-students-are-compromising-their-schools-internal-networks-5e8603bf1ae1" class="markup--anchor markup--p-anchor" target="_blank">https://medium.com/thedeephub/how-students-are-compromising-their-schools-internal-networks-5e8603bf1ae1</a></p><h3 name="854f" id="854f" class="graf graf--h3 graf-after--p">Chapter 4: Chromebook vulnerabilities</h3><p name="8964" id="8964" class="graf graf--p graf-after--h3">Now, in my humble opinion, Chromebooks reduce the attack surface of the education sector significantly. I’ve never seen such a tight operating system that seriously values access control and global policies. Not only was the OS built on a strong, secure codebase, but the vulnerabilities discovered are taken seriously and patched as soon as they’re discovered (Google is known to do this with many products it’s quite impressive).</p><p name="f283" id="f283" class="graf graf--p graf-after--p">Now, due to the way Chromebooks operate, the vulnerabilities and bypasses are significantly different. I’ll begin by explaining the easiest low-hanging fruits to the more complex ones.</p><p name="826a" id="826a" class="graf graf--p graf-after--p">Chromebooks have an option that allows you to boot into developer mode, from there you can run commands to unmount the drive, wipe all policies, and reset the hardware. From there, you can download a fresh installation of ChromeOS without the school’s restrictions. However, this is very simple to patch through simple configurations and this is 9/10 times not going to be possible anyway.</p><figure name="3d98" id="3d98" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*liZJFCSh_W32bqic.jpg" data-width="1280" data-height="720" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*liZJFCSh_W32bqic.jpg"></figure><p name="34bb" id="34bb" class="graf graf--p graf-after--figure">The next method I saw during my time in infosec research was I came across a YouTube video that showed a kid taking apart his Chromebook, finding the policy chip, and physically scraping it off. This chip is designed to reload the organization’s policies every time it detects it’s been tampered with, over-written, or erased (this way even if developer mode is enabled and you re-install the operating system the chip will re-install it anyways leaving your efforts futile). Therefore, in theory, destroying the physical chip on the hardware layer allows you to bypass this access developer mode and simply reset the laptop. However, this design flaw has been quickly changed by Google and the policy chip’s location is now unknown and very likely to be embedded within another chip in the PCB. Moreover, the policy administrators of the schools can see when a device in unenrolled, therefore, this can lead to further investigation (kudos to Google!)</p><figure name="7640" id="7640" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*jQ-C1J0tMc0-kh5j.jpeg" data-width="500" data-height="314" src="https://cdn-images-1.medium.com/max/800/0*jQ-C1J0tMc0-kh5j.jpeg"></figure><p name="c31f" id="c31f" class="graf graf--p graf-after--figure">Network Vulnerabilities are the most effective for Chromebooks, and are incredibly difficult to learn. There are many group chats, discord servers, and hidden channels that disclose these techniques, and due to how difficult they were to discover they’re quite paranoid about anyone new joining (took me months). Upon entering these chats there were loads of files, tutorials, videos, and more. One of the most effective, quick bypasses was using a custom DNS server. Because ChromeOS filters out content using a DNS server, it’s possible to swap the DNS server on the laptop with one of your own. This allows restricted content, games, etc to be accessed. This could be done via the network settings and was incredibly simple. The difficult part was hosting a DNS server, maintaining it, and load-balancing all the traffic. Yes, there’s now a policy and patch for this as well.</p><p name="df26" id="df26" class="graf graf--p graf-after--p">Lastly, restrictions can be placed on the extension level as well. LightSpeed Filter Agent has a Google Chrome extension that is loaded by default by the school’s policies and cannot be removed. However, due to ChromeOS’s design, it was possible to abuse their private system API via javascript bookmark and disable these extensions allowing for a full bypass of GoGuardian (for student monitoring) and LightSpeed (for content blocking). Thankfully, this did not allow for black-listed extensions to be loaded.</p><figure name="485c" id="485c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*lyAM9W-pW4EZO4cm.png" data-width="499" data-height="437" src="https://cdn-images-1.medium.com/max/800/0*lyAM9W-pW4EZO4cm.png"><figcaption class="imageCaption">Loading this bookmark will pop an alert, this can allow for JS execution if the school has disabled Inspect Element, Developer Tools, or running javascript in the URL directly.</figcaption></figure><p name="c08f" id="c08f" class="graf graf--p graf-after--figure">Lastly, the most common (and well-known) method of bypassing restrictions is to use domains that have not been black-listed by WAFS or filter agents and then slapping a proxy search engine on top of it (such as TitaniumNetwork which is open source on Github).</p><figure name="1cf2" id="1cf2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*oOCFKZPD2zgmeUli.png" data-width="2600" data-height="1088" src="https://cdn-images-1.medium.com/max/800/0*oOCFKZPD2zgmeUli.png"></figure><p name="8c60" id="8c60" class="graf graf--p graf-after--figure">The list can go on for days, there are too many techniques students use to get past these, and unfortunately, the security pitfalls can lead to system-level access and even escalation to network permissions.</p><h3 name="5ad7" id="5ad7" class="graf graf--h3 graf-after--p">Chapter 5: Default or Predictable Credentials</h3><p name="ee57" id="ee57" class="graf graf--p graf-after--h3">Many schools have default accounts for testing, guests, etc that are sometimes over-privileged. Moreover, many schools have passwords designed off of the student ID (which can be searched by anyone in the mailing system) such as this:<br>last 4 digits+initials+DOB year</p><p name="6a28" id="6a28" class="graf graf--p graf-after--p">This is incredibly insecure and dangerous and to make matters worse elementary schoolers at the time I went were actively abusing this to bully, troll, and annoy their peers — I myself fell victim to this.</p><figure name="547d" id="547d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*gI8XJHy5bVWqC-ze.gif" data-width="360" data-height="269" src="https://cdn-images-1.medium.com/max/800/0*gI8XJHy5bVWqC-ze.gif"><figcaption class="imageCaption">Let’s say the password for this student “Fake Name” with a DOB of 8/12/05 was <strong class="markup--strong markup--figure-strong">5789FN05. </strong>See, it’s predictable.</figcaption></figure><h3 name="23ab" id="23ab" class="graf graf--h3 graf-after--figure">Chapter 6: Remediation and Defenses</h3><figure name="81d9" id="81d9" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="0*NPCqDw1LmdMQu7K2.png" data-width="525" data-height="715" src="https://cdn-images-1.medium.com/max/800/0*NPCqDw1LmdMQu7K2.png"></figure><p name="a8fe" id="a8fe" class="graf graf--p graf-after--figure">Many of the techniques described above have existed for years and can be prevented through basic implementations.</p><ol class="postList"><li name="89c6" id="89c6" class="graf graf--li graf-after--p">Let’s start with the dual-booting, this can be prevented by <strong class="markup--strong markup--li-strong">disabling</strong> safe mode, or by password protecting it (like the BIOS).</li><li name="b64c" id="b64c" class="graf graf--li graf-after--li">The app-blocking policy bypass can be fixed via a <strong class="markup--strong markup--li-strong">custom</strong> policy, <strong class="markup--strong markup--li-strong">encompassing</strong> <strong class="markup--strong markup--li-strong">all</strong> <strong class="markup--strong markup--li-strong">drives</strong> and ANY application.</li><li name="a26e" id="a26e" class="graf graf--li graf-after--li">The hard drive’s contents can still be physically removed from the laptop, and read in an external reader, so to defend against this a <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">TPM</em></strong> with encryption should be applied for the <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">data-at-rest</em></strong>.</li><li name="fb80" id="fb80" class="graf graf--li graf-after--li">A <strong class="markup--strong markup--li-strong">firewall</strong> should be placed on the network level. Moreover, the proxy should be routing data to a school proxy designed specifically for these personal laptops. Not only does this allow more efficient monitoring of student activities, but allows for patches to be pushed easily through a central server.</li><li name="e68f" id="e68f" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Integrity</strong> <strong class="markup--strong markup--li-strong">checks</strong> at the hardware level (TPM) or even software level (via files and hashes) should ALWAYS be implemented and if these <strong class="markup--strong markup--li-strong">hashes</strong> do not match then simply fail to continue and alert administrators.</li><li name="16a5" id="16a5" class="graf graf--li graf-after--li">Regular <strong class="markup--strong markup--li-strong">updates</strong>, <strong class="markup--strong markup--li-strong">patching</strong>, and <strong class="markup--strong markup--li-strong">monitoring</strong></li><li name="eca2" id="eca2" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Zero</strong>-<strong class="markup--strong markup--li-strong">trust</strong> network design</li><li name="500c" id="500c" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">MFA</strong>, secure <strong class="markup--strong markup--li-strong">SSO</strong> vendors (preferably Microsoft), passwords with <strong class="markup--strong markup--li-strong">entropy</strong>.</li><li name="5c36" id="5c36" class="graf graf--li graf-after--li graf--trailing">Do not ever store passwords at rest (including wifi), <strong class="markup--strong markup--li-strong">use</strong> <strong class="markup--strong markup--li-strong">encryption</strong>, <strong class="markup--strong markup--li-strong">integrity</strong>, and <strong class="markup--strong markup--li-strong">monitoring</strong> <strong class="markup--strong markup--li-strong">of</strong> <strong class="markup--strong markup--li-strong">sensitive</strong> <strong class="markup--strong markup--li-strong">files</strong> being accessed.</li></ol></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@alimuhammadsecured" class="p-author h-card">Alimuhammadsecured</a> on <a href="https://medium.com/p/0a4bed4cbc93"><time class="dt-published" datetime="2024-07-16T23:37:19.148Z">July 16, 2024</time></a>.</p><p><a href="https://medium.com/@alimuhammadsecured/how-students-are-compromising-their-schools-internal-networks-part-2-0a4bed4cbc93" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 14, 2024.</p></footer></article></body></html>
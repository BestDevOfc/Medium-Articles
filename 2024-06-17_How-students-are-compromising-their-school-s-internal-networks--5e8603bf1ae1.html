<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How students are compromising their school’s internal networks.</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How students are compromising their school’s internal networks.</h1>
</header>
<section data-field="subtitle" class="p-summary">
This is information I’ve learned throughout the years of my time in public education going far as back as elementary school!
</section>
<section data-field="body" class="e-content">
<section name="0d2e" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3302" id="3302" class="graf graf--h3 graf--leading graf--title">How students are compromising their school’s internal networks. Part 1</h3><p name="4744" id="4744" class="graf graf--p graf-after--h3">This article explores the vulnerabilities in school networks, focusing on how students compromise them. We discuss Active Directory, bypassing content filters, and Chromebooks. We explain how students escalate their privileges allowing them to access restricted resources, and even leak school data using dual-booting. Moreover, security flaws such as default credentials that lead to data breaches are explained. This article is meant to raise awareness and help better protect our education’s critical infrastructure. Read Part 2 here: <a href="https://medium.com/@alimuhammadsecured/how-students-are-compromising-their-schools-internal-networks-part-2-0a4bed4cbc93" data-href="https://medium.com/@alimuhammadsecured/how-students-are-compromising-their-schools-internal-networks-part-2-0a4bed4cbc93" class="markup--anchor markup--p-anchor" rel="nofollow" target="_blank">https://medium.com/@alimuhammadsecured/how-students-are-compromising-their-schools-internal-networks-part-2-0a4bed4cbc93</a></p><h3 name="854f" id="854f" class="graf graf--h3 graf-after--p">Chapter 1: Active Directory</h3><p name="b9c8" id="b9c8" class="graf graf--p graf-after--h3">Before we get started it’s important to understand what school servers are built on before we talk about how they are compromised and exactly what is being “compromised”. When you log in to your school PCs have you ever noticed how you can use any PC or laptop but it somehow has all your files and documents? Or how about every computer knowing your account exists without you needing to create it on every computer? This is done by Active Directory this is a service that can get pretty complex but typically it’s made up of a RADIUS (authentication), a ticketing server (Kerberos), and the client (your computer authenticating). Of course, these servers are within the school network (intranet) and cannot be accessed over the internet directly unless some sort of VPN or gateway is being used (Palo Alto being a common one).</p><figure name="699e" id="699e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*wvqB4m0ivQ7Wq-BH.png" data-width="600" data-height="495" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*wvqB4m0ivQ7Wq-BH.png"><figcaption class="imageCaption">If the domain controller (which has full access to the active directory) is compromised the whole network is PWNED and can be manipulated at will.</figcaption></figure><p name="cc9a" id="cc9a" class="graf graf--p graf-after--figure">Chapter 2: Personal Laptops</p><p name="0add" id="0add" class="graf graf--p graf-after--p">When COVID-19 hit students were given their own personal Windows laptops and Chromebooks to take home and complete their assignments. Due to the severity and urgency, these devices were issued without the proper security configuration and designs. We’ll be focusing primarily on Windows laptops (the most common) and Google Chromebooks. The Google Chromebooks were developed by Google and are designed for productivity and security weeding out the bloatware and security faults inherent in Windows (we’ll take about this more).</p><figure name="4deb" id="4deb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*8ARBuWoppSZLrOpl.jpg" data-width="1280" data-height="720" src="https://cdn-images-1.medium.com/max/800/0*8ARBuWoppSZLrOpl.jpg"></figure><h3 name="6abb" id="6abb" class="graf graf--h3 graf-after--figure">Chapter 3: Dual booting (Windows)</h3><p name="fcdf" id="fcdf" class="graf graf--p graf-after--h3">These laptops issued by the schools have software and policy restrictions that prevent you from accessing certain sites such as gaming, social media, or streaming. However, I noticed something particularly interesting when visiting these blocked sites, there would be a redirect to <a href="https://localhost:PORT_NUMBER/STUDENT_ID?blocked_URL=UID." data-href="https://localhost:PORT_NUMBER/STUDENT_ID?blocked_URL=UID." class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://localhost:PORT_NUMBER/STUDENT_ID?blocked_URL=UID.</a> Hmm… this means that the blocking is being done locally on the computer and not on the network level. This would make sense since the same behavior can be observed when being blocked from a site on your home wifi (as they don’t have control over it they still need a way of blocking). Fueled by curiosity I decided to figure out a bypass or learn more about these security functionalities for my research paper.</p><figure name="a8cf" id="a8cf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ku6ekpWyITWV7FjyXdEX8A.png" data-width="1365" data-height="768" src="https://cdn-images-1.medium.com/max/800/1*Ku6ekpWyITWV7FjyXdEX8A.png"><figcaption class="imageCaption">Located on Google, the URL is not shown but the root domain is <strong class="markup--strong markup--figure-strong">localhost</strong>.</figcaption></figure><p name="975d" id="975d" class="graf graf--p graf-after--figure">I tried accessing files in the “<strong class="markup--strong markup--p-strong">Program Files</strong>” C drive (these contents include data, caches, and configurations for software on your Windows laptop), <strong class="markup--strong markup--p-strong">AppData</strong>, and more. However, the computer had policy restrictions that denied even read access. I decided I’d still try to access these files on the drive using <strong class="markup--strong markup--p-strong">dual-booting</strong>. Dual booting allows multiple operating systems on one hard drive via partitioning. Therefore, you can have Windows 10, Windows 11, and Windows 7 (depending on your hard drive’s size) on one drive.</p><figure name="4fc5" id="4fc5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*CzIoorqDUkIIPZaW.png" data-width="1024" data-height="768" src="https://cdn-images-1.medium.com/max/800/0*CzIoorqDUkIIPZaW.png"></figure><p name="4d53" id="4d53" class="graf graf--p graf-after--figure">In theory, by dual booting Windows 10, and creating an Admin account, I should now have escalated privileges and be able to access the school’s files and contents through the other Windows operating system on the same drive with no issues. However, the laptop’s policies had restricted BIOS with a password pin, rate-limiting (impressive), and with any developer options completely disabled. There are ways to find the default BIOS password used by manufacturers by looking up the model number on websites such as bios-pw.org, but this did not work as the password set was custom to the schools. However, there was one pitfall: <strong class="markup--strong markup--p-strong">Safe</strong> <strong class="markup--strong markup--p-strong">Mode</strong>.</p><figure name="29e5" id="29e5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*q-cJflhtWNxYPUOc.jpg" data-width="592" data-height="370" src="https://cdn-images-1.medium.com/max/800/0*q-cJflhtWNxYPUOc.jpg"></figure><p name="fe66" id="fe66" class="graf graf--p graf-after--figure">Safe Mode is a feature in Windows that allows troubleshooting, load drives, and much more without authentication. Safe mode can be accessed on the login screen by holding the <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">SHIFT</em></strong> key down and clicking on the <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">restart</em></strong> button. This blue screen pops up with many options, the one that caught my eye was the “<strong class="markup--strong markup--p-strong">Use</strong> <strong class="markup--strong markup--p-strong">a Device</strong>”. I popped in my bootable Windows 10 USB and booted off of it. After some research, I realized by running the windows on the bootable USB I could create a partition using <strong class="markup--strong markup--p-strong">diskpart</strong>.<strong class="markup--strong markup--p-strong">exe</strong> which I accessed from the system32-level CMD and created a partition.</p><figure name="8f4a" id="8f4a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*x5lGK6NAUNbY5xG7sNu6rQ.png" data-width="790" data-height="593" src="https://cdn-images-1.medium.com/max/800/1*x5lGK6NAUNbY5xG7sNu6rQ.png"></figure><p name="26b5" id="26b5" class="graf graf--p graf-after--figure">Luckily, the school’s hard drive was JUST big enough for another Windows OS to fit (if not I’d have to use Linux or something else). I installed the Windows on the new partition, logged in, and went to the drive of the school contents on drive D:\. After a few hours, I finally found the software responsible for the content blocking-<strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Lightspeed</em></strong>.</p><figure name="ed39" id="ed39" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*mkZOND41C9PJ0TVj.jpg" data-width="1280" data-height="720" src="https://cdn-images-1.medium.com/max/800/0*mkZOND41C9PJ0TVj.jpg"></figure><p name="39b6" id="39b6" class="graf graf--p graf-after--figure">Lightspeed is a proprietary filtering agent meant for the public education sector. After looking at the files present that the LightSpeed agent uses, I noticed the file “<strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">LSProxy.exe</em></strong>”. Hmm, this seems interesting because proxies sit in between you and the content you want, and proxies can also redirect you to a block page like the one we saw earlier being hosted on localhost. So out of curiosity I simply renamed the file to something else, then rebooted the laptop, chose the school OS this time, and logged in.</p><figure name="5462" id="5462" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*lNY6SAv_BBBWzsfI.jpeg" data-width="1000" data-height="600" src="https://cdn-images-1.medium.com/max/800/0*lNY6SAv_BBBWzsfI.jpeg"></figure><p name="0087" id="0087" class="graf graf--p graf-after--figure">Moment of truth… I opened up Google Chrome, typed in Discord and it worked! I could not believe how poor this security design really was. At the very least a static hash could have been downloaded and checked to see if the contents of the LightSpeed Agent files have maintained integrity (even Malware developers do this), but for some reason, this was not the case.</p><p name="b24c" id="b24c" class="graf graf--p graf-after--p">After doing more research, I came to the realization that I could download and load my own EXEs and applications bypassing the native block policy. You see, Window’s has a policy that blocks applications from running like this one:</p><figure name="d777" id="d777" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*nbZR1L1iKYFdxQJ3.png" data-width="690" data-height="406" src="https://cdn-images-1.medium.com/max/800/0*nbZR1L1iKYFdxQJ3.png"></figure><p name="0c64" id="0c64" class="graf graf--p graf-after--figure">After some Googling, it turns out that Windows’s default policy block will turn a blind eye to applications being loaded on different drives or certain file paths. I realized this by mistake when I downloaded Firefox Portable on my “escalated” Windows partition and tried running it from the restricted school partition and it opened!</p><figure name="8a0b" id="8a0b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*fb4OUqgREChl15My" data-width="1920" data-height="1080" src="https://cdn-images-1.medium.com/max/800/0*fb4OUqgREChl15My"><figcaption class="imageCaption">many apps have been modified to be portable (run on one drive — USB without creating files in the root directories, hence making them “<strong class="markup--strong markup--figure-strong"><em class="markup--em markup--figure-em">portable</em></strong>”).</figcaption></figure><p name="35f2" id="35f2" class="graf graf--p graf-after--figure">Now this leads to a whole new world of security concerns. For example, Firefox allows you to download extensions, one of which is a Windscribe proxy extension. Through this, I was now able to completely mask my internet traffic by using a VPN proxy and could even keep the LightSpeed LSProxy agent enabled!</p><figure name="f275" id="f275" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*NQFP5-28g8yEBq3f" data-width="1280" data-height="800" src="https://cdn-images-1.medium.com/max/800/0*NQFP5-28g8yEBq3f"><figcaption class="imageCaption">They also have one available for Chrome</figcaption></figure><p name="c45d" id="c45d" class="graf graf--p graf-after--figure">Okay, so students can now access Discord and Netflix-so what? The security issue comes into play considering the dangerous amount of confidential data stored on the school OS itself, which can now be accessed freely, manipulated, and used. Moreover, un-indexed malware can now also be loaded freely, this includes keyloggers, ransomware, and so much more. I say un-indexed because if the hash of the executable is not stored in the database, it’s possible to bypass the anti-virus completely. In particular, many organizations use CarbonBlack AV which can be bypassed this way.</p><figure name="6f58" id="6f58" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*25PimdtqXGLpaf4o.png" data-width="1814" data-height="1134" src="https://cdn-images-1.medium.com/max/800/0*25PimdtqXGLpaf4o.png"><figcaption class="imageCaption">Is a next generation SaaS EDR.</figcaption></figure><p name="8fef" id="8fef" class="graf graf--p graf-after--figure">Moreover, now that apps can be loaded students can pull the network credentials off the device using <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Netsh. However, </em></strong>many network administrators now use an encryption key instead of the actual password. Therefore, students can pull this key, load it onto their unrestricted partition, download <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Nmap</em></strong>, and start compromising the internal network. This is because of the lack of zero-trust networks-once you’re inside the walls the security posture significantly decreases.</p><figure name="844b" id="844b" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="0*q4InfKec05AP3mV6.png" data-width="1483" data-height="792" src="https://cdn-images-1.medium.com/max/800/0*q4InfKec05AP3mV6.png"><figcaption class="imageCaption">Shows saved wifi passwords in cleartext saved on the device via “<strong class="markup--strong markup--figure-strong">Netsh</strong>”.</figcaption></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@alimuhammadsecured" class="p-author h-card">Alimuhammadsecured</a> on <a href="https://medium.com/p/5e8603bf1ae1"><time class="dt-published" datetime="2024-06-17T01:30:33.804Z">June 17, 2024</time></a>.</p><p><a href="https://medium.com/@alimuhammadsecured/how-students-are-compromising-their-schools-internal-networks-5e8603bf1ae1" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 14, 2024.</p></footer></article></body></html>